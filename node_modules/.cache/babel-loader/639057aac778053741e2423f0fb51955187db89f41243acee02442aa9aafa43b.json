{"ast":null,"code":"import React,{useEffect,useRef}from'react';import*as d3 from'd3';import{formatLabel}from'../../data/DrinkNutritionModel';import'./BubbleChart.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function BubbleChart(_ref){let{data,nutrient,category}=_ref;const ref=useRef();useEffect(()=>{if(!data||data.length===0)return;let bubblesData;if(category==='drinks'){const grouped=d3.groups(data,d=>d.category);bubblesData=grouped.map(_ref2=>{let[cat,items]=_ref2;const valid=items.filter(d=>d[nutrient]!==undefined&&!isNaN(d[nutrient]));const avg=d3.mean(valid,d=>+d[nutrient]);return{label:cat,value:avg};}).filter(d=>!isNaN(d.value));}else{// For food, group by category and compute average\nconst groupedFood=d3.groups(data,d=>d.category);bubblesData=groupedFood.map(_ref3=>{let[cat,items]=_ref3;const valid=items.filter(d=>d[nutrient]!==undefined&&!isNaN(d[nutrient]));const avg=d3.mean(valid,d=>+d[nutrient]);return{label:cat,value:avg};}).filter(d=>!isNaN(d.value));}const svg=d3.select(ref.current);svg.selectAll('*').remove();const container=svg.node().parentElement;const width=container.clientWidth;const totalHeight=container.clientHeight;const headerHeight=40;const availableHeight=totalHeight-headerHeight-20;const maxValue=d3.max(bubblesData,d=>d.value);const radiusRange=[30,70];const scale=d3.scaleSqrt().domain([0,maxValue]).range(radiusRange);const yCenter=headerHeight+availableHeight/2;const simulation=d3.forceSimulation(bubblesData).force('x',d3.forceX(width/2).strength(0.05)).force('y',d3.forceY(yCenter).strength(0.1)).force('collide',d3.forceCollide(d=>scale(d.value)+4)).stop();for(let i=0;i<100;i++)simulation.tick();svg.attr('viewBox',\"0 0 \".concat(width,\" \").concat(totalHeight)).attr('preserveAspectRatio','xMidYMid meet');const g=svg.selectAll('g').data(bubblesData).enter().append('g').attr('transform',d=>\"translate(\".concat(d.x,\",\").concat(d.y,\")\"));g.append('circle').attr('r',d=>scale(d.value)).attr('fill','#00704A').attr('stroke','#e76f51').attr('stroke-width',1).attr('opacity',0.85);g.append('text').style('text-anchor','middle').style('font-size',d=>\"\".concat(Math.min(scale(d.value)/3,12),\"px\")).style('fill','white').style('pointer-events','none').selectAll('tspan').data(d=>{const words=d.label.split(' ');const lines=[];for(let i=0;i<words.length;i+=2){lines.push(words.slice(i,i+2).join(' '));}return lines;}).enter().append('tspan').attr('x',0).attr('dy',function(_,i,nodes){const totalLines=nodes.length;const lineHeight=1.2;const firstDy=-((totalLines-1)/2)*lineHeight;return i===0?\"\".concat(firstDy,\"em\"):\"\".concat(lineHeight,\"em\");}).text(d=>d);},[data,nutrient,category]);const headerText=category==='drinks'?\"Average \".concat(formatLabel(nutrient),\" by Type of Drinks\"):\"Average \".concat(formatLabel(nutrient),\" Across Food Categories\");return/*#__PURE__*/_jsxs(\"div\",{className:\"bubble-chart-container\",children:[/*#__PURE__*/_jsx(\"h3\",{children:headerText}),/*#__PURE__*/_jsx(\"svg\",{ref:ref})]});}export default BubbleChart;","map":{"version":3,"names":["React","useEffect","useRef","d3","formatLabel","jsx","_jsx","jsxs","_jsxs","BubbleChart","_ref","data","nutrient","category","ref","length","bubblesData","grouped","groups","d","map","_ref2","cat","items","valid","filter","undefined","isNaN","avg","mean","label","value","groupedFood","_ref3","svg","select","current","selectAll","remove","container","node","parentElement","width","clientWidth","totalHeight","clientHeight","headerHeight","availableHeight","maxValue","max","radiusRange","scale","scaleSqrt","domain","range","yCenter","simulation","forceSimulation","force","forceX","strength","forceY","forceCollide","stop","i","tick","attr","concat","g","enter","append","x","y","style","Math","min","words","split","lines","push","slice","join","_","nodes","totalLines","lineHeight","firstDy","text","headerText","className","children"],"sources":["/Users/marlin/Desktop/Starbucks-Nutrition-Dashboard/src/components/bubblechart/BubbleChart.js"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\nimport * as d3 from 'd3';\nimport { formatLabel } from '../../data/DrinkNutritionModel';\nimport './BubbleChart.css';\n\nfunction BubbleChart({ data, nutrient, category }) {\n    const ref = useRef();\n\n    useEffect(() => {\n        if (!data || data.length === 0) return;\n\n        let bubblesData;\n\n        if (category === 'drinks') {\n            const grouped = d3.groups(data, d => d.category);\n            bubblesData = grouped\n                .map(([cat, items]) => {\n                    const valid = items.filter(d => d[nutrient] !== undefined && !isNaN(d[nutrient]));\n                    const avg = d3.mean(valid, d => +d[nutrient]);\n                    return { label: cat, value: avg };\n                })\n                .filter(d => !isNaN(d.value));\n        } else {\n            // For food, group by category and compute average\n            const groupedFood = d3.groups(data, d => d.category);\n            bubblesData = groupedFood\n                .map(([cat, items]) => {\n                    const valid = items.filter(d => d[nutrient] !== undefined && !isNaN(d[nutrient]));\n                    const avg = d3.mean(valid, d => +d[nutrient]);\n                    return { label: cat, value: avg };\n                })\n                .filter(d => !isNaN(d.value));\n        }\n\n        const svg = d3.select(ref.current);\n        svg.selectAll('*').remove();\n\n        const container = svg.node().parentElement;\n        const width = container.clientWidth;\n        const totalHeight = container.clientHeight;\n        const headerHeight = 40;\n        const availableHeight = totalHeight - headerHeight - 20;\n\n        const maxValue = d3.max(bubblesData, d => d.value);\n        const radiusRange = [30, 70];\n        const scale = d3.scaleSqrt().domain([0, maxValue]).range(radiusRange);\n\n        const yCenter = headerHeight + availableHeight / 2;\n\n        const simulation = d3.forceSimulation(bubblesData)\n            .force('x', d3.forceX(width / 2).strength(0.05))\n            .force('y', d3.forceY(yCenter).strength(0.1))\n            .force('collide', d3.forceCollide(d => scale(d.value) + 4))\n            .stop();\n\n        for (let i = 0; i < 100; i++) simulation.tick();\n\n        svg\n            .attr('viewBox', `0 0 ${width} ${totalHeight}`)\n            .attr('preserveAspectRatio', 'xMidYMid meet');\n\n        const g = svg.selectAll('g')\n            .data(bubblesData)\n            .enter()\n            .append('g')\n            .attr('transform', d => `translate(${d.x},${d.y})`);\n\n        g.append('circle')\n            .attr('r', d => scale(d.value))\n            .attr('fill', '#00704A')\n            .attr('stroke', '#e76f51')\n            .attr('stroke-width', 1)\n            .attr('opacity', 0.85);\n\n        g.append('text')\n            .style('text-anchor', 'middle')\n            .style('font-size', d => `${Math.min(scale(d.value) / 3, 12)}px`)\n            .style('fill', 'white')\n            .style('pointer-events', 'none')\n            .selectAll('tspan')\n            .data(d => {\n                const words = d.label.split(' ');\n                const lines = [];\n                for (let i = 0; i < words.length; i += 2) {\n                    lines.push(words.slice(i, i + 2).join(' '));\n                }\n                return lines;\n            })\n            .enter()\n            .append('tspan')\n            .attr('x', 0)\n            .attr('dy', function (_, i, nodes) {\n                const totalLines = nodes.length;\n                const lineHeight = 1.2;\n                const firstDy = -((totalLines - 1) / 2) * lineHeight;\n                return i === 0 ? `${firstDy}em` : `${lineHeight}em`;\n            })\n            .text(d => d);\n    }, [data, nutrient, category]);\n\n    const headerText =\n        category === 'drinks'\n            ? `Average ${formatLabel(nutrient)} by Type of Drinks`\n            : `Average ${formatLabel(nutrient)} Across Food Categories`;\n\n    return (\n        <div className=\"bubble-chart-container\">\n            <h3>{headerText}</h3>\n            <svg ref={ref}></svg>\n        </div>\n    );\n}\n\nexport default BubbleChart;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}